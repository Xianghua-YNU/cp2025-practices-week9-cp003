# 迭代函数系统(IFS)分形实验报告

## 实验目的

1. 理解迭代函数系统(IFS)的基本原理和算法
2. 掌握"混沌游戏"随机迭代方法
3. 实现巴恩斯利蕨和概率树的生成
4. 分析不同参数对分形图形的影响

## 实验过程

### 1. 核心算法实现

**IFS参数定义**:
- 巴恩斯利蕨: 4个仿射变换(茎干、小叶片、左右大叶片)
- 概率树: 3个仿射变换(树干、左右分支)

**混沌游戏算法**:
1. 初始化起始点
2. 随机选择变换(按概率)
3. 应用仿射变换生成新点
4. 重复迭代生成点集

### 2. 分形实现

**巴恩斯利蕨参数**:
- 茎干变换: 概率0.01
- 小叶片变换: 概率0.85
- 左右大叶片变换: 各概率0.07

**概率树参数**:
- 树干变换: 概率0.10
- 左右分支变换: 各概率0.45

### 3. 遇到的问题与解决

(请在此描述实现过程中遇到的问题及解决方法)

## 结果展示

### 1. 巴恩斯利蕨
[插入生成的巴恩斯利蕨分形图]
![barnsley_fern](https://github.com/user-attachments/assets/f72bc56e-cdf0-41bc-b3c9-29bada49b58a)
- 展示不同变换对应的叶片部分
- 分析概率参数对叶片密度的影响
茎干 (p=0.01)
概率极低，茎干点稀疏，但通过仿射变换（垂直压缩）形成细长的茎干形态。若提高 p（如改为 0.05），茎干会变粗，但可能破坏蕨类的自然形态。
小叶片 (p=0.85)
高频变换，生成大量点填充叶片区域，形成密集的叶片主体。若降低 p（如改为 0.7），叶片会显得稀疏，可能失去“蕨类”的茂盛感。
大叶片 (p=0.07)
低频变换，生成的点较少，形成叶片边缘的稀疏轮廓。若提高 p（如改为 0.15），大叶片会变得更密集，可能与小叶片区域重叠。

### 2. 概率树 
[插入生成的概率树分形图]
![probability_tree](https://github.com/user-attachments/assets/af330d4c-57e4-4c31-a390-60ec5f556f82)
- 展示分支结构
- 分析变换参数对树形的影响
树干 (p=0.10)
低频变换，形成稀疏的垂直线（树干）。若提高 p（如 0.20），树干会变粗，但可能挤占分支空间。
左右分支 (p=0.45)
高频变换，生成密集的分支结构。若降低 p（如 0.30），树会显得简单，单调，分支减少。

## 分析与思考

1. **IFS特性分析**
   - 仿射变换参数对图形各部分的影响
茎干部分 (a=0, b=0, c=0, d=0.16)：仅 d=0.16 生效：垂直方向高度压缩，形成细长茎干。其他参数为0：无旋转或剪切，保持垂直直线。
小叶片 (a=0.85, d=0.85)：a 和 d 接近1：近似等比例缩放，保持叶片形状稳定。
b=0.04, c=-0.04：轻微剪切，使叶片自然弯曲。
大叶片 (b=-0.26, c=0.23)：较大的 b 和 c：显著倾斜和旋转，形成叶片边缘的弧度
   - 概率参数与图形密度的关系
高概率：区域点密集，形成主体结构，如：蕨类小叶片 p=0.85（占85%迭代次数）
低概率：区域点稀疏，生成轮廓或次要部分，如：蕨类茎干 p=0.01（仅1%迭代次数）

2. **参数实验**
   - 修改概率参数的效果
   - 调整变换参数的效果
增加小叶片密度，p=0.85 → p=0.90，叶片更茂密，但茎干可能消失，茎干因概率仅剩 0.01 几乎不可见
增加茎干密度，p=0.01 → p=0.05，茎干变粗，破坏纤细感	若同时减少小叶片的，p 可保持整体平衡
不对称调整，左叶片 p=0.07→0.10	左侧叶片更密集，图形不对称，右叶片未调整时，蕨类向左倾斜

3. **扩展思考**
   - 如何设计新的IFS规则生成其他分形
（1） 确定分形结构特征
基础形状：明确目标分形的核心结构（如树枝、雪花、山脉等）。
自相似性：分解为多个仿射变换的组合，每个变换对应局部结构。
（2） 设计仿射变换参数
缩放与旋转：通过 a, b, c, d 控制局部形状的变形。
例：生成科赫雪花时，需设计6个变换（缩放1/3，旋转±60°）。
平移：通过 e, f 定位子结构的位置。
（3） 分配概率参数
密度平衡：主体部分赋予高概率（如树干 p=0.4），细节部分低概率（如树叶 p=0.05）。
总和为1：确保所有 p 之和严格等于1。
   - 添加颜色渐变效果的方法
颜色映射：根据迭代次数使用 matplotlib.colors.LinearSegmentedColormap
   - 性能优化方案(减少点数同时保持视觉效果)
 动态点密度控制
非均匀采样：在高细节区域（如叶片边缘）保留更多点，平坦区域减少点
后处理降采样
网格化筛选：将空间划分为网格，每个网格保留1个代表点。
多分辨率渲染
分阶段绘制：首先生成低分辨率预览，再局部细化重点区域。
4. **算法比较**
   - IFS与其他分形生成方法的对比
FS：核心原理：通过仿射变换的迭代生成自相似结构;优点：参数直观，适合规则分形缺点；对复杂自然形态（如云彩）建模困难
L系统：核心原理：字符串重写规则模拟生长过程；优点：适合植物分枝结构；缺点：参数难调试，计算成本高
   - 随机迭代与确定性迭代的差异
特性	    随机迭代             	                确定性迭代   
迭代方式	 每次随机选择一个变换应用（概率驱动）	对所有变换同步应用，生成完整子结构
数学基础	 马尔可夫链，概率收敛到吸引子	         迭代函数系统的几何极限
输出结果	 点集近似分形结构	                     精确的分形几何图形

**注：请在每一部分补充你自己的实验内容、图像、分析和关键代码。**
